<!DOCTYPE html>
<html>
<head>
  <title>Messages</title>
  <style>
    body {
      background: #0a0f0a;
      color: #a8ffb5;
      font-family: "Courier New", monospace;
      line-height: 1.6;
      text-align: center;
      padding: 2em;
      margin: 0;
      overflow-x: hidden;
    }

    body::before {
      content: "";
      position: fixed;
      top:0; left:0; right:0; bottom:0;
      pointer-events: none;
      background: repeating-linear-gradient(
        to bottom,
        rgba(255,255,255,0.02),
        rgba(255,255,255,0.02) 1px,
        transparent 2px,
        transparent 3px
      );
      mix-blend-mode: overlay;
      z-index: 9999;
    }

    h1 {
      color: #66ff99;
      text-shadow: 0 0 4px #66ff99, 0 0 8px #a8ffb5;
    }

    #nav a {
      display: inline-block;
      margin: 0.5em;
      padding: 0.4em 1em;
      border: 1px solid #66ff99;
      border-radius: 6px;
      background: #0a0f0a;
      color: #66ff99;
      text-decoration: none;
      font-weight: bold;
      text-shadow: 0 0 2px #66ff99;
      transition: all 0.25s ease-in-out;
    }

    #nav a:hover {
      background: #66ff99;
      color: #0a0f0a;
      box-shadow: 0 0 6px #66ff99, 0 0 12px #33bb99;
    }

    #messages {
      max-width: 600px;
      margin: 1em auto;
      text-align: left;
      background: #001000;
      padding: 1em;
      border-radius: 8px;
      height: 300px;
      overflow-y: scroll;
      box-shadow: inset 0 0 10px #33ff77;
      font-size: 0.95rem;
    }

    input, button, select {
      padding: 0.5em;
      margin: 0.2em;
      border-radius: 6px;
      border: 1px solid #33ff77;
      font-family: monospace;
      font-size: 0.95rem;
    }

    button {
      cursor: pointer;
      background: #0a0f0a;
      color: #66ff99;
      font-weight: bold;
      text-shadow: 0 0 2px #33ff77;
      box-shadow: 0 0 4px #33ff77;
      transition: all 0.2s ease-in-out;
    }

    button:hover {
      background: #66ff99;
      color: #0a0f0a;
      box-shadow: 0 0 8px #33ff77, 0 0 16px #a8ffb5;
    }
  </style>
</head>
<body>
  <h1>MESSAGES</h1>
  <div id="nav">
    <a href="index.html">Back 2 Home</a>
    <a href="aboutmepage.html">About Me</a>
    <a href="sparklepage.html">My Thoughts</a>
    <a href="catchgame.html">Catching Game</a>
    <a href="buildastory.html">Build A Story</a>
    <a href="tinyworlds.html">Tiny Worlds</a>
    <a href="ambient.html">Ambient glow</a>
    <a href="flappy.html">Flappy Circle</a>


  </div>

  <div id="chatSetup">
    <p>Enter your personal password:</p>
    <select id="usernameSelect">
      <option value="">--Choose User--</option>
      <option value="Chloe">Chloe</option>
      <option value="Mckenna">Mckenna</option>
      <option value="Krishivaa">Krishivaa</option>
    </select>
    <input type="password" id="userPassword" placeholder="Personal password" />
    <button id="joinBtn">Join Chat</button>
  </div>

  <div id="chatInterface" style="display:none;">
    <div id="messages"></div>
    <input id="messageInput" placeholder="Type your message..." />
    <button onclick="sendMessage()">Send</button>
  </div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/12.6.0/firebase-app.js";
import { getDatabase, ref, push, onChildAdded } from "https://www.gstatic.com/firebasejs/12.6.0/firebase-database.js";

// Firebase setup
const firebaseConfig = {
  apiKey: "AIzaSyDFdFgheOQf7yks_uUMEnpJn1-RFCEv24s",
  authDomain: "chloe-chat-c15fb.firebaseapp.com",
  projectId: "chloe-chat-c15fb",
  storageBucket: "chloe-chat-c15fb.firebasestorage.app",
  messagingSenderId: "138132282670",
  appId: "1:138132282670:web:ff46d0101153240cbf2ebf"
};

const app = initializeApp(firebaseConfig);
const db = getDatabase(app);
const messagesRef = ref(db, "messages");

// Define usernames, passwords, and colors
const users = {
  "Chloe": { password: "cholera", color: "#ff66aa" },
  "Mckenna": { password: "microwave", color: "#66ccff" },
  "Krishivaa": { password: "mr.maker", color: "#ffffff" }
};

let currentUser = null;

// Join button logic
document.getElementById("joinBtn").onclick = function() {
  const selectedUser = document.getElementById("usernameSelect").value;
  const passInput = document.getElementById("userPassword").value;

  if(!selectedUser || !passInput) { alert("Choose a username and enter your password."); return; }

  if(users[selectedUser].password !== passInput) {
    alert("Incorrect personal password!");
    return;
  }

  currentUser = { name: selectedUser, color: users[selectedUser].color };
  document.getElementById("chatSetup").style.display = "none";
  document.getElementById("chatInterface").style.display = "block";
};

// Display messages in real-time
onChildAdded(messagesRef, (snapshot) => {
  const msg = snapshot.val();
  const div = document.createElement("div");
  div.innerHTML = `<strong style="color:${msg.color}">${msg.username}:</strong> ${msg.message}`;
  document.getElementById("messages").appendChild(div);
  document.getElementById("messages").scrollTop = document.getElementById("messages").scrollHeight;
});

// Send message
window.sendMessage = function() {
  const input = document.getElementById("messageInput");
  if(input.value && currentUser) {
    push(messagesRef, {
      username: currentUser.name,
      message: input.value,
      color: currentUser.color,
      timestamp: Date.now()
    });
    input.value = "";
  }
};
</script>
</body>
</html>
